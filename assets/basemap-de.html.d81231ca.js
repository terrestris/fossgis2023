import{I as b,l as g,M as x,E as N,u as v,t as z,a as M}from"./Source.13d28e10.js";import{a as S}from"./index.c6c0ea17.js";import"./featureloader.92da648c.js";import"./VectorTile.f3b960bc.js";import"./TileEventType.16115d42.js";import"./Vector.9be7778c.js";import"./BaseTile.8715c233.js";import"./net.792eb7fa.js";function P(i){return z(i,5)}function c(i){return parseFloat(i)}function f(i){return P(i).toString()}function m(i,t){return isNaN(i)?!1:i!==c(f(t))}function E(i,t){return m(i[0],t[0])||m(i[1],t[1])}class O extends b{constructor(t){super(),t=Object.assign({animate:!0,params:["x","y","z","r","l"],replace:!1,prefix:""},t||{});let e;t.animate===!0?e={duration:250}:t.animate?e=t.animate:e=null,this.animationOptions_=e,this.params_=t.params.reduce((r,s)=>(r[s]=!0,r),{}),this.replace_=t.replace,this.prefix_=t.prefix,this.listenerKeys_=[],this.initial_=!0,this.updateState_=this.updateState_.bind(this)}getParamName_(t){return this.prefix_?this.prefix_+t:t}get_(t,e){return t.get(this.getParamName_(e))}set_(t,e,r){e in this.params_&&t.set(this.getParamName_(e),r)}delete_(t,e){e in this.params_&&t.delete(this.getParamName_(e))}setMap(t){const e=this.getMap();super.setMap(t),t!==e&&(e&&this.unregisterListeners_(e),t&&(this.initial_=!0,this.updateState_(),this.registerListeners_(t)))}registerListeners_(t){this.listenerKeys_.push(g(t,x.MOVEEND,this.updateUrl_,this),g(t.getLayerGroup(),N.CHANGE,this.updateUrl_,this),g(t,"change:layergroup",this.handleChangeLayerGroup_,this)),this.replace_||addEventListener("popstate",this.updateState_)}unregisterListeners_(t){for(let s=0,o=this.listenerKeys_.length;s<o;++s)v(this.listenerKeys_[s]);this.listenerKeys_.length=0,this.replace_||removeEventListener("popstate",this.updateState_);const e=new URL(window.location.href),r=e.searchParams;this.delete_(r,"x"),this.delete_(r,"y"),this.delete_(r,"z"),this.delete_(r,"r"),this.delete_(r,"l"),window.history.replaceState(null,"",e)}handleChangeLayerGroup_(){const t=this.getMap();!t||(this.unregisterListeners_(t),this.registerListeners_(t),this.initial_=!0,this.updateUrl_())}updateState_(){const t=this.getMap();if(!t)return;const e=t.getView();if(!e)return;const s=new URL(window.location.href).searchParams;let o=!1;const n={},_=c(this.get_(s,"z"));"z"in this.params_&&m(_,e.getZoom())&&(o=!0,n.zoom=_);const u=c(this.get_(s,"r"));"r"in this.params_&&m(u,e.getRotation())&&(o=!0,n.rotation=u);const h=[c(this.get_(s,"x")),c(this.get_(s,"y"))];("x"in this.params_||"y"in this.params_)&&E(h,e.getCenter())&&(o=!0,n.center=h),o&&(!this.initial_&&this.animationOptions_?e.animate(Object.assign(n,this.animationOptions_)):(n.center&&e.setCenter(n.center),"zoom"in n&&e.setZoom(n.zoom),"rotation"in n&&e.setRotation(n.rotation)));const a=t.getAllLayers(),l=this.get_(s,"l");if("l"in this.params_&&l&&l.length===a.length)for(let p=0,L=a.length;p<L;++p){const d=parseInt(l[p]);if(!isNaN(d)){const y=Boolean(d),w=a[p];w.getVisible()!==y&&w.setVisible(y)}}}updateUrl_(){const t=this.getMap();if(!t)return;const e=t.getView();if(!e)return;const r=this.initial_;this.initial_=!1;const s=e.getCenter(),o=e.getZoom(),n=e.getRotation(),_=t.getAllLayers(),u=new Array(_.length);for(let l=0,p=_.length;l<p;++l)u[l]=_[l].getVisible()?"1":"0";const h=new URL(window.location.href),a=h.searchParams;this.set_(a,"x",f(s[0])),this.set_(a,"y",f(s[1])),this.set_(a,"z",f(o)),this.set_(a,"r",f(n)),this.set_(a,"l",u.join("")),h.href!==window.location.href&&(r||this.replace_?window.history.replaceState(history.state,"",h):window.history.pushState(null,"",h))}}const U=O;M();S("map","https://sgx.geodatenzentrum.de/gdz_basemapde_vektor/styles/bm_web_top.json").then(i=>{i.addInteraction(new U),console.log(i)});
