import{F as p}from"./Vector.680108bb.js";import{a_ as G,u as O,l as F,E as P,a$ as b,b0 as j,b1 as w,r as _,c as l,A as c,C as S,aC as C,aO as M,aN as N}from"./Source.c163b9e6.js";import{F as E,t as f,L as k,b as x,a as J,M as L}from"./Feature.b6b724ef.js";class g extends G{constructor(e){super(),this.geometries_=e||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(O),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(!!this.geometries_)for(let e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(F(this.geometries_[e],P.CHANGE,this.changed,this))}clone(){const e=new g(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e}closestPointXY(e,t,r,o){if(o<b(this.getExtent(),e,t))return o;const n=this.geometries_;for(let s=0,a=n.length;s<a;++s)o=n[s].closestPointXY(e,t,r,o);return o}containsXY(e,t){const r=this.geometries_;for(let o=0,n=r.length;o<n;++o)if(r[o].containsXY(e,t))return!0;return!1}computeExtent(e){j(e);const t=this.geometries_;for(let r=0,o=t.length;r<o;++r)w(e,t[r].getExtent());return e}getGeometries(){return d(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,o=t.length;r<o;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let o=!1;for(let n=0,s=r.length;n<s;++n){const a=r[n],u=a.getSimplifiedGeometry(e);t.push(u),u!==a&&(o=!0)}if(o){const n=new g(null);return n.setGeometriesArray(t),n}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,o=t.length;r<o;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let o=0,n=r.length;o<n;++o)r[o].rotate(e,t);this.changed()}scale(e,t,r){r||(r=_(this.getExtent()));const o=this.geometries_;for(let n=0,s=o.length;n<s;++n)o[n].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(d(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,o=t.length;r<o;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let o=0,n=r.length;o<n;++o)r[o].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function d(i){const e=[];for(let t=0,r=i.length;t<r;++t)e.push(i[t].clone());return e}const v=g;class A extends E{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(m(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(m(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return l()}readFeaturesFromObject(e,t){return l()}readGeometry(e,t){return this.readGeometryFromObject(m(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return l()}readProjection(e){return this.readProjectionFromObject(m(e))}readProjectionFromObject(e){return l()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return l()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return l()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return l()}}function m(i){if(typeof i=="string"){const e=JSON.parse(i);return e||null}else if(i!==null)return i;return null}const T=A;class R extends T{constructor(e){e=e||{},super(),this.dataProjection=c(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=c(e.featureProjection)),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const o=h(r.geometry,t),n=new p;return this.geometryName_?n.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in r!==void 0&&n.setGeometryName(r.geometry_name),n.setGeometry(o),"id"in r&&n.setId(r.id),r.properties&&n.setProperties(r.properties,!0),n}readFeaturesFromObject(e,t){const r=e;let o=null;if(r.type==="FeatureCollection"){const n=e;o=[];const s=n.features;for(let a=0,u=s.length;a<u;++a)o.push(this.readFeatureFromObject(s[a],t))}else o=[this.readFeatureFromObject(e,t)];return o}readGeometryFromObject(e,t){return h(e,t)}readProjectionFromObject(e){const t=e.crs;let r;return t?t.type=="name"?r=c(t.properties.name):t.type==="EPSG"?r=c("EPSG:"+t.properties.code):S(!1,36):r=this.dataProjection,r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},o=e.getId();if(o!==void 0&&(r.id=o),!e.hasProperties())return r;const n=e.getProperties(),s=e.getGeometry();return s&&(r.geometry=y(s,t),delete n[e.getGeometryName()]),C(n)||(r.properties=n),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let o=0,n=e.length;o<n;++o)r.push(this.writeFeatureObject(e[o],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return y(e,this.adaptOptions(t))}}function h(i,e){if(!i)return null;let t;switch(i.type){case"Point":{t=X(i);break}case"LineString":{t=Y(i);break}case"Polygon":{t=U(i);break}case"MultiPoint":{t=$(i);break}case"MultiLineString":{t=I(i);break}case"MultiPolygon":{t=H(i);break}case"GeometryCollection":{t=K(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return f(t,!1,e)}function K(i,e){const t=i.geometries.map(function(r){return h(r,e)});return new v(t)}function X(i){return new M(i.coordinates)}function Y(i){return new k(i.coordinates)}function I(i){return new x(i.coordinates)}function $(i){return new J(i.coordinates)}function H(i){return new L(i.coordinates)}function U(i){return new N(i.coordinates)}function y(i,e){i=f(i,!0,e);const t=i.getType();let r;switch(t){case"Point":{r=Z(i);break}case"LineString":{r=W(i);break}case"Polygon":{r=q(i,e);break}case"MultiPoint":{r=Q(i);break}case"MultiLineString":{r=z(i);break}case"MultiPolygon":{r=V(i,e);break}case"GeometryCollection":{r=B(i,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function B(i,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(r){return y(r,e)})}}function W(i,e){return{type:"LineString",coordinates:i.getCoordinates()}}function z(i,e){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function Q(i,e){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function V(i,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(t)}}function Z(i,e){return{type:"Point",coordinates:i.getCoordinates()}}function q(i,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(t)}}const re=R;export{re as G,v as a};
